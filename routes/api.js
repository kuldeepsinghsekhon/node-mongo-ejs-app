const express = require('express');
const passport = require('passport');
const {ensureAuthenticated, forwardAuthenticated } = require('../config/auth');
const { permit } = require('../config/role-auth');
const router = express.Router();
const settings_controller = require('../controllers/settings.controller');
const product_controller = require('../controllers/api.product.controller');
const auth_controller = require('../controllers/auth.controller');
const utils_controller = require('../controllers/utils.controller');
router.post('/products/',passport.authenticate(['local'], { session : false }),product_controller.products);
router.get('/products/:id',forwardAuthenticated, product_controller.findById );
router.get('/products/sell/:id',ensureAuthenticated, product_controller.sellProductVariant );
router.post('/products/sell/:id/',ensureAuthenticated, product_controller.sellAsk );
router.post('/products/cal',ensureAuthenticated, product_controller.sellCalculateCharges);
router.get('/products/sell/:id/pay',ensureAuthenticated, product_controller.sellProductOrAsk );
router.post('/products/sell/:id/pay',ensureAuthenticated, product_controller.sellProductPay );
router.get('/products/buy/:id',ensureAuthenticated, product_controller.buyProductVariant );
router.post('/products/buy/:id/',ensureAuthenticated, product_controller.placeBuyBid );
router.post('/products/calcbuy',ensureAuthenticated, product_controller.calculateBuyCharges);
router.post('/user/settings/resetpsword',ensureAuthenticated,settings_controller.requestResetPassword);
router.post('/change_password',ensureAuthenticated, auth_controller.updateChangePassword);
router.get('/user/settings/profile',ensureAuthenticated, settings_controller.profileInfo);
router.post('/user/settings/update-profile',ensureAuthenticated, settings_controller.saveProfile);
router.post('/user/settings/seller-info',ensureAuthenticated, settings_controller.saveSellerInfo);
router.post('/user/settings/shipping-info',ensureAuthenticated, settings_controller.saveShippingInfo);
router.post('/user/settings/buyer-info',ensureAuthenticated, settings_controller.saveBuyerInfo);
router.post('/user/settings/address-info',passport.authenticate('local', { session : true }), settings_controller.addressInfo);
router.post('/sign-in',passport.authenticate(['local']),auth_controller.signIn);
router.post('/sign-up',auth_controller.signUp);
router.get('/countries',forwardAuthenticated, utils_controller.allCoutries);
module.exports = router;